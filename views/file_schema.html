<!-- tab content for step2 generate schema -->
<div class="w3-panel secondtab--{{database.filename}}" id="schema_panel--{{database.filename}}">
    <!-- detail content for step2 generate schema -->
    <div class="w3-panel" id="detail_schema_panel--{{database.filename}}">
        <h5><i class="fa fa-cube w3-text-green w3-large"></i> {{database.filename}} &emsp;
            <span class="badge bg-primary rounded-pill">
                {{database.dimensions.length}} {{session=='Expert'?'Dimensions':'Analysis Axis'}}
            </span>
            &emsp;&emsp;
            <span class="badge bg-primary rounded-pill">
                {{database.facts.length}} {{session=='Expert'?'Fact':'Subject'}}{{if database.facts.length > 1}}s{{/if}}
            </span>
            &emsp;&emsp;
            <button type="button" id="edit_name_icon--{{database.filename}}" class="w3-button w3-light-grey w3-section w3-text-blue"
                style="text-align: right;">
                <i class="fas fa-edit w3-large"></i>
            </button>
            &emsp;&emsp;
            <form action="post" id="edit_name_form--{{database.filename}}">
                <button type="button" id="save_name_icon--{{database.filename}}" class="w3-button w3-light-grey w3-section w3-text-blue"
                style="text-align: right;" disabled="disabled">
                <i class="fas fa-save w3-large"></i>
            </button>
            </form>
        </h5>

        <!-- nav tab for different dimensions -->
        <nav>
            <div class="nav nav-tabs" id="nav-tab dimension--{{database.filename}}" role="tablist">
                {{each database.dimensions dim indexdim}}
                {{if indexdim==0}}
                <button class="nav-link active text-uppercase"
                    id="nav-{{database.filename + '_' + dim.name + '_' + indexdim}}-tab" data-bs-toggle="tab"
                    data-bs-target="#nav-{{database.filename + '_' + dim.name+ '_' + indexdim}}" type="button"
                    role="tab" aria-controls="nav-{{database.filename + '_' + dim.name+ '_' + indexdim}}"
                    aria-selected="true">{{dim.name}}</button>
                {{else}}
                <button class="nav-link text-uppercase"
                    id="nav-{{database.filename + '_' + dim.name+ '_' + indexdim}}-tab" data-bs-toggle="tab"
                    data-bs-target="#nav-{{database.filename + '_' + dim.name+ '_' + indexdim}}" type="button"
                    role="tab" aria-controls="nav-{{database.filename + '_' + dim.name+ '_' + indexdim}}"
                    aria-selected="false">{{dim.name}}</button>
                {{/if}}
                {{/each}}
            </div>
        </nav>
        <!-- nav tab for different dimensions ===end==== -->

        <!-- container to put all detail information about the dimensions -->
        <div class="mb-3" style="height:500px;">
            <div class="tab-content" id="nav-tabContent dimension--{{database.filename}}">
                <!-- container for all detail information about each dimension -->
                {{each database.dimensions dim indexdim}}
                <div class="tab-pane fade {{if indexdim==0}} show active {{/if}} overflow-scroll"
                    id="nav-{{database.filename + '_' + dim.name + '_' + indexdim}}" role="tabpanel"
                    aria-labelledby="nav-{{database.filename + '_' + dim.name + '_' + indexdim}}-tab" tabindex="0">

                    <!-- add a modal for date dimension -->
                    {{if dim.name == 'Date' || dim.name == 'DATE' || dim.name == 'date'}}
                    <p>You can select the attributes for the {{session=="Expert"? 'hierarchies':
                        'analysis visions'}} about the
                        date.
                    </p>
                    <!-- Button trigger modal -->
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                        data-bs-target="#select_date_modal--{{database.filename}}">Select
                    </button>
                    <!-- Vertically centered scrollable modal -->
                    <div class="modal fade" id="select_date_modal--{{database.filename}}" tabindex="-1"
                        aria-labelledby="select_date_modal_label--{{database.filename}}" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="select_date_modal_label--{{database.filename}}">
                                        Select date {{session=="Expert"? 'hierarchy':
                                        'analysis vision'}} attributes
                                    </h1>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                                    </button>
                                </div>
                                <!-- Modal Content -->
                                <div class="modal-body">
                                    <p id="p_select_date--{{database.filename}}">Select
                                        &emsp;&emsp;
                                        <label class="form-check-label">
                                            None
                                        </label>
                                        <input type="checkbox" name="select_date"
                                            id="select_date--{{database.filename}}" checked>
                                        <label class="form-check-label">
                                            All
                                        </label>
                                    </p>
                                    <form id="select_date_form--{{database.filename}}"
                                        name="select_date_form--{{database.filename}}" method="post"
                                        action="/file/hie/date/{{database.filename}}">
                                        <input class="form-check-input" type="checkbox" name="date" id="date_date"
                                            form="select_date_form--{{database.filename}}" checked>
                                        <label class="form-check-label" for="date_date">
                                            Date
                                        </label>
                                        <input class="form-check-input" type="checkbox" name="date" id="date_week"
                                            form="select_date_form--{{database.filename}}" checked>
                                        <label class="form-check-label" for="date_week">
                                            Week
                                        </label>
                                        <input class="form-check-input" type="checkbox" name="date" id="date_month"
                                            form="select_date_form--{{database.filename}}" checked>
                                        <label class="form-check-label" for="date_month">
                                            Month
                                        </label>
                                        <input class="form-check-input" type="checkbox" name="date" id="date_season"
                                            form="select_date_form--{{database.filename}}" checked>
                                        <label class="form-check-label" for="date_season">
                                            Quarter
                                        </label>
                                        <input class="form-check-input" type="checkbox" name="date" id="date_semester"
                                            form="select_date_form--{{database.filename}}" checked>
                                        <label class="form-check-label" for="date_semester">
                                            Semester
                                        </label>
                                        <input class="form-check-input" type="checkbox" name="date" id="date_year"
                                            form="select_date_form--{{database.filename}}" checked>
                                        <label class="form-check-label" for="date_year">
                                            Year
                                        </label>
                                    </form>
                                </div>
                                <!-- Modal Content ===end=== -->
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal">Cancel</button>
                                    <button type="button" class="btn btn-primary" id="btn_date">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end of addModal -->
                    {{/if}}
                    <!-- add a modal for date dimension ===end=== -->

                    <!-- Table for Detail information of each dimension -->
                    <!-- New table for edit  -->
                    <table class="table table-striped table-hover">
                        <tr>
                            <th width="20%">
                                {{session=='Expert'? 'Dimension':'Analysis Axis'}} {{indexdim + 1}} <br>
                                <span class="w3-text-grey" style="font-size: 10px;">
                                    {{dim.hierarchies.length}}
                                    {{session=='Expert'? 'Hierarchies':'Analysis Visions'}}
                                </span>
                            </th>
                            <th>
                                <a href="javascript:;" class="editattribute dimname_{{indexdim}}"
                                    style="text-decoration: none;">{{dim.name}}</a>
                            </th>
                        </tr>
                        <tr>
                            <th width="20%">
                                Attributes <br>
                                <span class="w3-text-grey" style="font-size: 10px;">
                                    {{dim.attributes.length}}
                                    Attributes</span>
                            </th>
                            <td>
                                {{each dim.attributes a indexA}}
                                {{if indexA==dim.attributes.length-1}} {{a}} {{else}} {{a + ","}} {{/if}}
                                {{/each}}
                            </td>
                        </tr>
                        <tr id="all_hie--{{dim.name}}">
                            <th colspan="2">
                                <div class="row justify-content-around">
                                    <div class="col-4" style="text-align: center;">
                                        {{session=='Expert'? 'Hierarchies':'Analysis Visions'}} &emsp;&emsp;
                                        <span class="badge bg-primary rounded-pill">
                                            {{dim.hierarchies.length}}</span>
                                    </div>
                                    <div class="col-4">
                                        <i class="fa fa-caret-up"></i>
                                    </div>
                                </div>
                            </th>
                        </tr>
                        {{each dim.hierarchies h indexh}}
                        <tr>
                            <th width="20%">
                                {{session=='Expert'? 'Hierarchy':'Analysis Vision'}} {{indexh + 1}}
                                <i width="30px" height="30px" viewBox="0 0 20 20" class="fa fa-info-circle"
                                    data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true"
                                    data-bs-title="In this {{session=='Expert'? 'dimension':'analysis axis'}}, you have following {{session=='Expert'? 'hierarchies':'analysis visions'}}."></i>

                            </th>
                            <td id="hie--{{dim.name + '_' + indexh}}">
                                <div class="row justify-content-between">
                                    <div class="col-4">
                                        <a href="javascript:;" class="editattribute hiename_{{indexdim}}_{{indexh}}"
                                            style="text-decoration: none;">{{h.name}}</a>
                                    </div>
                                    <div class="col-4">
                                        <i class="fa fa-caret-up">
                                        </i>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail_hie--{{dim.name + '_' + indexh}}">
                            <th width="20%">
                                - {{session=='Expert'? 'Parameters':'Levels'}} <i width="30px" height="30px"
                                    viewBox="0 0 20 20" class="fa fa-info-circle w3-padding" data-bs-toggle="tooltip"
                                    data-bs-placement="top" data-bs-html="true"
                                    data-bs-title="In this {{session=='Expert'? 'hierarchy':'analysis vision'}}, you have following {{session=='Expert'? 'parameters':'levels'}}."></i>
                            </th>
                            <td>
                                {{each h.parametres p indexP}}
                                {{p}}{{indexP!==h.parametres.length-1 ? ", ":""}}
                                {{/each}}
                            </td>
                        </tr>
                        <tr class="detail_hie--{{dim.name + '_' + indexh}}">
                            <th width="20%">
                                - {{session=='Expert'? 'Weak Attributes':'Supplementary information'}} <i width="30px"
                                    height="30px" viewBox="0 0 20 20" class="fa fa-info-circle" data-bs-toggle="tooltip"
                                    data-bs-placement="top" data-bs-html="true"
                                    data-bs-title="The {{session=='Expert'? 'parameter':'level'}} contain following {{session=='Expert'? 'weak attributes':'supplementary information'}}.">
                                </i>
                            </th>
                            <td>
                                {{each h.weak_att wka indexWKA}}
                                {{wka.name}}: {{each wka.wk w indeW}} {{w}}
                                {{indeW!==wka.wk.length-1? "," : ""}}
                                {{/each}}
                                {{if indexWKA!==h.weak_att.length-1}},{{/if}}
                                {{/each}}
                            </td>
                        </tr>
                        {{/each}}
                    </table>
                    <!-- end of edit table -->

                    <!-- Table for Detail information of each dimension ===end=== -->
                </div>
                {{/each}}
            </div>
            <!-- container for all detail information about each dimension ===end=== -->
        </div>
        <!-- container to put all detail information about the dimensions ===end==== -->

        <hr>
        <!-- nav tab for different facts -->
        <nav>
            <div class="nav nav-tabs" id="nav-tab fact--{{database.filename}}" role="tablist">
                {{each database.facts fact indexf}}
                {{if indexf==0}}
                <button class="nav-link active text-uppercase"
                    id="nav-{{database.filename + '_' + fact.name + '_' + indexf}}-tab" data-bs-toggle="tab"
                    data-bs-target="#nav-{{database.filename + '_' + fact.name + '_' + indexf}}" type="button"
                    role="tab" aria-controls="nav-{{database.filename + '_' + fact.name + '_' + indexf}}"
                    aria-selected="true">{{fact.name}}</button>
                {{else}}
                <button class="nav-link text-uppercase"
                    id="nav-{{database.filename + '_' + fact.name + '_' + indexf}}-tab" data-bs-toggle="tab"
                    data-bs-target="#nav-{{database.filename + '_' + fact.name + '_' + indexf}}" type="button"
                    role="tab" aria-controls="nav-{{database.filename + '_' + fact.name + '_' + indexf}}"
                    aria-selected="false">{{fact.name}}</button>
                {{/if}}
                {{/each}}
            </div>
        </nav>
        <!-- end of nav tab for different facts ===end=== -->

        <!-- container for all facts' detail information -->
        <div class="mb-2 ">
            <div class="tab-content fact--{{database.filename}}" id="nav-tabContent fact--{{database.filename}}">
                {{each database.facts fact indexf}}
                <div class="tab-pane fade {{if indexf==0}}show active{{/if}} overflow-scroll"
                    id="nav-{{database.filename + '_' + fact.name + '_' + indexf}}" role="tabpanel"
                    aria-labelledby="nav-{{database.filename + '_' + fact.name + '_' + indexf}}-tab" tabindex="0">
                    <table class="table table-hover table-responsive">
                        <tr>
                            <th scope="col" style="width: 20%">{{session=="Expert"? 'Fact':'Subject'}}</th>
                            <td scope="row" class="text-uppercase fw-bold">
                                <a href="javascript:;" class="editattribute factname{{indexf}}" style="text-decoration: none;">{{fact.name}}</a>
                            </td>
                        </tr>
                        <tr>
                            <th scope="col">
                                {{session=="Expert"? 'Measures':'Indicators'}}
                                <i width="30px" height="30px" viewBox="0 0 20 20" class="fa fa-info-circle"
                                    data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true"
                                    data-bs-title="In this subject, you have following {{session=='Expert'? 'measures':'indicators'}}.">
                                </i>
                            </th>
                            <td>
                                {{each fact.measures measure indexm}}
                                {{if indexm==fact.measures.length-1}} {{measure}} {{else}} {{measure + ","}} {{/if}}
                                {{/each}}
                            </td>
                        </tr>
                        <tr>
                            <th scope="col">Associated to</th>
                            <td>
                                {{each fact.associations assoc indexass}}
                                {{if indexass==fact.associations.length-1}} {{assoc}} {{else}} {{assoc + ", "}} {{/if}}
                                {{/each}}
                            </td>
                        </tr>
                    </table>
                </div>
                {{/each}}
                <!-- end of container for all facts' detail information -->
            </div>
        </div>
        <!-- container for the facts ===end==== -->

        <!-- Button trigger modal -->
        <div class="row justify-content-between">
            <div class="col-4">
                {{if session=='Expert'}}
                <!-- button 1 Edit Schema -->
                <button id="open_edit_schema_modal--{{database.filename}}" type="button" class="btn btn-primary"
                    data-bs-toggle="modal" data-bs-target="#edit_schema_modal--{{database.filename}}">
                    Edit Schema
                </button>
                {{/if}}
            </div>
            <div class="col-4">
                <!-- button 2 Confirme to Create DB -->
                <button id="btn_createdb_modal--{{database.filename}}" type="button" class="btn btn-primary"
                    data-bs-toggle="modal" data-bs-target="#createdb_modal--{{database.filename}}">
                    Create Database
                </button>
            </div>
        </div>

        <!-- edit schema modal Modal 1 -->
        <div class="modal fade" id="edit_schema_modal--{{database.filename}}" tabindex="-1"
            aria-labelledby="edit_schema_modal--{{database.filename}}" aria-hidden="true">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="edit_schema_modal--{{database.filename}}">
                            Modify the data warehouse schema
                        </h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <pre id="json-display" contenteditable="true" class="{{cls}}" class="form-control" name="schema"
                                form="edit_schema_form--{{database.filename}}" width="500px" hight = "auto">{{schema}}
                            </pre>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <form id="edit_schema_form--{{database.filename}}"
                            name="edit_schema_form--{{database.filename}}" method="post"
                            action="/file/schema/edit/{{database.filename}}">
                            <button type="button" class="btn btn-primary"
                                id="btn_edit_schema--{{database.filename}}">Save
                                changes</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- end of Modal 1 ===end==== -->

        <!-- Create DB Information Modal 2-->
        <div class="modal fade" id="createdb_modal--{{database.filename}}" tabindex="-1"
            aria-labelledby="createdb_modal--{{database.filename}}" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="createdb_modal--{{database.filename}}">
                            Enter the database
                            information
                        </h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3 row">
                            <label for="createUser" class="col-sm-4 col-form-label">User
                                Name</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control" id="username--{{database.filename}}"
                                    name="username" form="createdb_form--{{database.filename}}">
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <label for="createPassword" class="col-sm-4 col-form-label">Enter
                                Password</label>
                            <div class="col-sm-6">
                                <input type="password" class="form-control" id="createPassword" name="password">
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <label for="pwd--{{database.filename}}" class="col-sm-4 col-form-label">Confirm
                                Password</label>
                            <div class="col-sm-6">
                                <input type="password" class="form-control" id="pwd--{{database.filename}}" name="pwd"
                                    form="createdb_form--{{database.filename}}"></td>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <form id="createdb_form--{{database.filename}}" name="createdb_form--{{database.filename}}"
                            method="post" action="/filusername--{{database.filename}}e/adddb/{{database.filename}}">
                            <button type="button" class="btn btn-primary"
                                id="btn_createdb_save--{{database.filename}}">Save</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- Create DB Modal 2 ===end=== -->

        <!-- button to go back or to go next step -->
        <br>
        <div class="row justify-content-between">
            <div class="col-4">
                <a href="#measure_panel--{{database.filename}}" style="text-decoration: none; color: black; font-size: larger;">
                    <button class="w3-button w3-light-grey w3-padding-large w3-section" type="button">
                        <i class="fa fa-arrow-left"></i> Return
                    </button>
                </a>
            </div>
            <div class="col-4">
                <button class="w3-button w3-light-grey w3-padding-large w3-section"
                    id="btn_schema--{{database.filename}}" type="button">
                    <span style="font-size: larger; color: blue;">
                        Next <i class="fa fa-arrow-right"></i>
                    </span>
                </button>
            </div>
        </div>
        <!-- button to go back or to go next step ===end=== -->
    </div>
    <script src="../static/js/file_schema.js"></script>
</div>
<!-- tab content for step2 generate schema ===end=== -->